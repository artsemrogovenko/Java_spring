<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" type="text/css" th:href="@{../styles.css}"/>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>


<script>
        $(document).ready(function() {
           $(".prevButton, .nextButton").on("click", function() {
            // Получить значение из data-prev-value или data-next-value атрибута кнопки
            var value = $(this).data("prev-value") || $(this).data("next-value");
<!--        data-prev-value хранит значение ${characters.info.prev1} для первой кнопки и ${characters.info.prev2} для второй кнопки.-->
<!--JavaScript затем использует $(this).data("prev-value") для получения значения при нажатии на конкретную кнопку.-->

                // Выполнить AJAX-запрос
                $.ajax({
                    url: "/updateCharacterApi",
                    type: "POST", // Используйте POST или GET в зависимости от вашего случая
                    data: { value: value },
                    success: function(response) {
                        console.log("Успешно выполнен AJAX-запрос!");
                        window.location.href = '/web';  // Редирект на новую страницу
                    },
                    error: function(error) {
                        console.error("Ошибка при выполнении AJAX-запроса");
                    }
                });

                // Если вы хотите перенаправить пользователя после выполнения AJAX-запроса, вы можете использовать:
                // window.location.href = '/web';
            });
        });

</script>

<table>
    <thead>
    <tr>
        <th>Count Characters</th>
        <th>Pages</th>
        <th>next page</th>
        <th>prev page</th>
    </tr>
    <tr>
        <td th:text="${characters.info.count}"></td>
        <td th:text="${characters.info.pages}"></td>

        <button type="submit" class="nextButton" th:if="${characters.info.next != null}" data-next-value="${characters.info.next}">
            Следующая страница
        </button>

        <button type="submit" class="prevButton" th:if="${characters.info.prev != null}" data-prev-value="${characters.info.prev}">
            Предыдущая страница
        </button>


    </tr>
    </thead>
    <tbody>
    </tbody>


    <div th:each="character: ${characters.results}">
        <div class="character-card">
            <a th:href="@{${character.url}}">
                <img th:src="@{${character.image}}" alt="">

                <ul style="list-style-type: none">
                    <li th:text="${character.id}"></li>
                    <li th:text="${character.name}"></li>
                    <li>

                        <th>
                        <td class="status-circle"
                            th:if="${character.status eq 'Alive'} or ${character.status eq 'Dead'}"
                            th:class="${character.status eq 'Alive' ? 'status-alive' : 'status-dead'}"></td>
                        <td th:text="${character.status}" style="margin-left:20px"></td>
                        </th>

                    </li>


                    <li th:text="${character.species}"></li>
                    <li th:text="${character.type}"></li>
                    <li th:text="${character.gender}"></li>
                    <!--            <li th:text="${character.image}"></li>-->
                    <!--            <li th:text="${character.url}"></li>-->
                    <li th:text="${character.created}"></li>
                </ul>
            </a>
        </div>

    </div>


</table>

</body>
</html>